#!/usr/bin/env ruby
APP_PATH = File.expand_path('../../config/application',  __dir__)
require_relative '../config/boot'
require_relative '../config/environment'

unless ARGV.size == 1
  puts "Usage: #{__FILE__} dataset.csv"
  exit 1
end

filename = ARGV[0]

unless File.exists? filename
  puts "Could not open file #{filename}"
  exit 1
end

result = Indexer.index_csv(filename)

puts "Done! Imported:"
puts "\t-#{result[:imported_facilities]} facilities"
puts "\t-#{result[:imported_services]} services"
puts "\t-#{result[:imported_locations]} locations"
